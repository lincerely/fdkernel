SYS.COM (FD98)
==============

FreeDOSのSYS.COMには主にふたつの用途があります。

1. システム転送。PC-98シリーズのハードディスク内に確保されたDOS領域に、FreeDOS(98)のシステム(KERNEL.SYS, COMMAND.COM)をコピーし、そのDOS領域内の先頭セクタにあるブートローダーをFreeDOS(98)用に変更します。
2. カーネル設定(CONFIG)。FreeDOS(98)のカーネル(KERNEL.SYS)の設定を書きかえます。変更した設定はシステムの再起動後に有効となります。

現時点（2020-02-11）でFreeDOS(98)用のSYS.COMは、本家に対してだいぶ古いバージョンのものとなっており、システム転送時のオプションはほぼ使用できません。
また、カーネル設定時のパラメータは、本家IBM PC版とPC-98版とで同じパラメータであっても使用上の意味が異なる場合があります。


用法（システム転送）
-------------------

システム転送時のコマンド用法は、MS-DOS版とほぼ同じです。
FreeDOS(98)のSYSコマンドはFreeDOS(98)だけでなく、MS-DOS（バージョン3.1以上）やWindows95/98のシングルMS-DOSモードからでも実行可能です。

[書式]

  SYS [転送元パス] 転送先ドライブ:

    転送元パス      コピーするKERNEL.SYSとCOMMAND.COMの存在するパス。
                    指定してない場合、現行ドライブのルートディレクトリとなる。

    転送先ドライブ  システムのコピー先を示すドライブ文字。
                    転送元パスにあるKERNEL.SYSとCOMMAND.COMが、転送先ドライブ
                    のルートディレクトリにコピーされ、転送先ドライブ領域内の
                    先頭セクタにあるブートローダーが、FreeDOS(98)のものに
                    置きかわる。
                    （転送元パスにCOMMAND.COMが存在しない場合、環境変数
                    COMSPECで指定されているデフォルトシェルがコピーされる）

[用例]

  SYS B:
        （現行ドライブがFreeDOS(98)システムの場合）FreeDOS(98)システムを
         B ドライブに転送する。

  SYS A:\FDOS C:
        A:\FDOSにあるFreeDOS(98)のシステムファイルを C ドライブに転送する。

[注意]

すでに他のOSをインストールしたドライブ上にSYSコマンドでシステム転送を行った後は、以前のOSは起動できなくなります。
また、以前のOSのシステムファイルは特に消去されることはありません（MS-DOSのIO.SYSとMSDOS.SYSはFAT上で「予約領域」に配置されているため、属性解除して強制的に削除しようとしても空き領域は増えません）。


用法（カーネル設定）
-------------------

※この設定記述は2020-02-11時点でのものです。将来は変更される可能性があります。

[書式1]

  SYS CONFIG [カーネルファイル名]

    カーネルファイル名
        設定状態を見たいカーネルのファイル名。
        指定していない場合、現行ディレクトリ上にあるKERNEL.SYSとなる。
        （「現行ドライブのルート」ではない点に注意）

[用例1]

  SYS CONFIG
        現行ディレクトリにあるKERNEL.SYSの設定を表示。

  SYS CONFIG \kernel.sys
        現行ドライブのルートディレクトリにあるKERNEL.SYSの設定を表示。

[書式2]

  SYS CONFIG [カーネルファイル名] 項目名=数値 [項目名2=数値2] ...

    カーネルファイル名
        設定を変更したいカーネルのファイル名。
        指定していない場合、現行ディレクトリ上にあるKERNEL.SYSとなる。

    項目名
        変更したい設定項目名。最初の3文字の後は省略可能。
    数値
        設定の数値。
        基本的に１バイトなので、0 から 255の範囲で設定可能。
        符号つきの値を設定する項目の場合は -128 から 127まで。
        数値の先頭に0xをつけることにより16進数の記述が可能。

[項目名と値の説明]

※この設定記述は2020-02-11時点でのPC-98用カーネルのものです。

  DLASORT               ドライブ文字の割り当て方式を変更します。

    0x00 (0)    MS-DOS互換の割り当て方式となります（初期設定値）。
                FDから起動した場合は先頭FDDが A ドライブとなり、存在する
                FDDの分だけドライブ文字が割り当てられたのち、HDD内にある
                DOS領域のドライブ文字が割り当てられます。
                また、HDから起動した場合は先頭HD内にある最初のDOS領域が
                A ドライブとなり、すべてのHD内にあるDOS領域にドライブが
                割り当てられたのち、FDDにドライブ文字が割り当てられます。

    0x80 (128)  0 と同様。

    0x81 (129)  IBM PC用のDOSとほぼ同じ割り当て方式となります。
                A と B のドライブがFDDに割り当てられ（FDDがひとつ以下の
                場合も）、HD内のDOS領域に C ドライブが割り当てられます。
                

    0x82 (130)  FDから起動した場合でも、先頭HD内にある最初のDOS領域が
                A ドライブとなります。つまり、FD起動時もHD起動時と同じ
                ドライブ構成にすることができます。

    0x83 (131)  HDから起動した場合でも、先頭FDDが A ドライブとなります。
                つまり、HD起動時もFD起動時と同じドライブ構成にすることが
                できます。

    0xF0 (240)  FD専用モード。
                HD内の領域チェックを行わないため、FDDのみにドライブ文字が
                割り当てられます。
                HDが初期化されていない（もしくは別機種で初期化されている）
                ことでHD内の領域チェックが誤動作し、DOSが正常に起動しない
                場合、この設定でFDから起動し、ディスク初期化ユーティリティ
                を実行するといった緊急処置をとることができます。

  SHOWDRIVEASSIGNMENT   ドライブ文字割り当ての表示／非表示

       1        起動時にドライブ文字の割り当て状況を表示します。
                （初期設定値）

       0        起動時にドライブ文字の割り当て状況を表示しません。
                （コピーライト表示は消えません。念のため）

  SKIPCONFIGSECONDS     起動時のCONFIG.SYS処理までの待ち時間（秒数）
                        -128 から 127 まで指定可能。
                        -1 以下、もしくは 128 以上を指定した場合、ただちに
                        CONFIG.SYSが処理されるようになります（0 と同じ）。
                        （初期設定値は 2）

  FORCELBA              ハードディスクアクセス時のLBAモード使用

       1        LBAモードを常に使用します。
                （2021-01-22以降の初期設定値）

       0        CHSモードを使用します。（以前の初期設定値）
                PC-98シリーズのハードディスクBIOSはLBAモードを標準サポート
                しているため、特別な事情がない限り、0に設定する必要は
                ありません。

  GLOBALENABLELBASUPPORT
                        IBM PC互換のDOS領域認識
                        ※本機能は試験的に実装されたものです。実際の機能と
                        設定の名称が異なることもあり、今後別名になる可能性が
                        あります。

       1        IBM PC系DOS用に初期化されたHD内のDOS領域を認識するように
                なります。（現在、8086対応FAT32カーネルでは未サポート）
                FORCELBAも1に設定してください。

       0        NEC/EPSON系MS-DOSの拡張フォーマットされたHDのみを認識します。
                （初期設定値）

[用例2]

  SYS CONFIG \kernel.sys dla=0x82
        ドライブ文字割り当て方式をHD優先に変更。

  SYS CONFIG \kernel.sys for=1 glo=1 sho=1 ski=5
        IBM PC系DOS互換のHD領域を認識できるように変更し、起動時に
        割り当て状況を表示、CONFIG.SYSの処理待ちを5秒に設定。

